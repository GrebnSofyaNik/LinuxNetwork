## Part 1. Готовый докер

1. Проверила наличие докер образа через `docker images`

![pg1](img/01.png)<br/>

2. Взяла официальный докер образ с **nginx** и выкачать его при помощи `docker pull`

![pg1](img/02.png)<br/>

3. Снова проверила наличие докер образа через `docker images`

![pg1](img/03.png)<br/>

4. Запустила докер образ через `docker run -d [image_id|repository]`

![pg1](img/04.png)<br/>

` -d: это флаг, который указывает Docker на запуск контейнера в фоновом режиме (detached mode). Это означает, что контейнер будет работать в фоновом режиме, и командная строка будет освобождена для дальнейшего использования.`

5. Проверила, что образ запустился через `docker ps`

![pg1](img/05.png)<br/>

`Команда docker ps используется для вывода списка запущенных контейнеров Docker.
При запуске команды docker ps без дополнительных флагов будут отображены только запущенные контейнеры в текущий момент времени.`

6. Посмотрела информацию о контейнере через `docker inspect [container_id|container_name]`

Вот полная информация о запущенном контейнере:

![pg1](img/06.png)<br/>

7. По выводу команды определить и поместить в отчёт размер контейнера, список замапленных портов и ip контейнера

- Размер контейнера:

![pg1](img/07.png) <br/>

- Список замапленных портов:

![pg1](img/08.png)<br/>

`Это для отображения только информации о привязках портов контейнера` 

- Список портов можно также посмотреть через 'docker inspect' в разделе 'Network':

![pg1](img/09.png)<br/>

`Маппинг нужен для того, чтобы все запросы, проходящие через порт хоста, перенаправлялись в Docker-контейнер. Другими словами, сопоставление портов делает процессы внутри контейнера доступными извне.`

- IP:

![pg1](img/10.png)<br/>

7. Остановила докер образ через `docker stop [container_id|container_name]`

![pg1](img/11.png)<br/>

- и проверила, что образ остановился через `docker ps`

![pg1](img/12.png)<br/>


9. Запустила докер с портами 80 и 443 в контейнере, замапленными на такие же порты на локальной машине, через команду *run*

![pg1](img/13.png)<br/>


10. Проверила, что в браузере по адресу *localhost:80* доступна стартовая страница **nginx**

![pg1](img/14.png)<br/>

11. Перезапустила докер контейнер через `docker restart [container_id|container_name]`
12. Проверила, что контейнер запустился

![pg1](img/15.png)<br/>

## Part 2. Операции с контейнером

##### Прочитала конфигурационный файл *nginx.conf* внутри докер контейнера через команду *exec*

![pg1](img/16.png)<br/>

##### Создала на локальной машине файл *nginx.conf*
##### Настроила в нем по пути */status* отдачу страницы статуса сервера **nginx**

![pg1](img/17.png)<br/>

##### Скопировала созданный файл *nginx.conf* внутрь докер образа через команду `docker cp`

![pg1](img/18.png)<br/>

##### Перезапустила **nginx** внутри докер образа через команду *exec*

![pg1](img/19.png)<br/>

##### Проверила, что о адресу *localhost:80/status* отдается страничка со статусом сервера **nginx**

![pg1](img/20.png)<br/>

![pg1](img/21.png)<br/>

##### Экспортировала контейнер в файл *container.tar* через команду *export*
![pg1](img/22.png)<br/>
##### Остановила контейнер

![pg1](img/23.png)<br/>
##### Удалила образ через `docker rmi [image_id|repository]`, не удаляя перед этим контейнеры

![pg1](img/24.png)<br/>

##### Удалила остановленный контейнер

![pg1](img/25.png)<br/>

##### Импортировала контейнер обратно через команду *import*

![pg1](img/26.png)<br/>

##### Запустила импортированный контейнер

![pg1](img/27.png)<br/>
![pg1](img/28.png)<br/>

##### Проверить, что по адресу *localhost:80/status* отдается страничка со статусом сервера **nginx**

![pg1](img/29.png)<br/>

## Part 3. Мини веб-сервер

1. Написать мини сервер на **C** и **FastCgi**, который будет возвращать простейшую страничку с надписью `Hello World!`

![pg1](img/30.png)<br/>

2. Запустить написанный мини сервер через *spawn-fcgi* на порту 8080

Запускаем образ

![pg1](img/31.png)<br/>

Копируем файлы

![pg1](img/32.png)<br/>

Входим в режим командной строки образа

![pg1](img/33.png)<br/>

Выполняем команды

`apt update`

`apt-get install libfcgi-dev`

`apt-get install spawn-fcgi`

`apt-get install gcc`

`gcc -Wall -Werror -Wextra main.c -lpthread -lfcgi -o server`

`spawn-fcgi -p 8080 -n ./server`

`nginx -s reload`

3. Написать свой *nginx.conf*, который будет проксировать все запросы с 81 порта на *127.0.0.1:8080*

![pg1](img/34.png)<br/>

4. Проверить, что в браузере по *localhost:81* отдается написанная вами страничка

![pg1](img/35.png)<br/>

5. Положить файл *nginx.conf* по пути *./nginx/nginx.conf* (это понадобится позже)

`cp nginx.conf ../04/nginx/nginx.conf`

## Part 4. Свой докер

#### Написать свой докер образ, который:
##### 1) собирает исходники мини сервера на FastCgi из [Части 3](#part-3-мини-веб-сервер)
##### 2) запускает его на 8080 порту
##### 3) копирует внутрь образа написанный *./nginx/nginx.conf*
##### 4) запускает **nginx**.
_**nginx** можно установить внутрь докера самостоятельно, а можно воспользоваться готовым образом с **nginx**'ом, как базовым._
##### Собрать написанный докер образ через `docker build` при этом указав имя и тег

![pg1](img/36.png)<br/>

##### Проверить через `docker images`, что все собралось корректно

![pg1](img/37.png)<br/>

##### Запустить собранный докер образ с маппингом 81 порта на 80 на локальной машине и маппингом папки *./nginx* внутрь контейнера по адресу, где лежат конфигурационные файлы **nginx**'а (см. [Часть 2](#part-2-операции-с-контейнером))

`sudo docker run -it -p 80:81 --name testserver -v /home/andrey/DO5_SimpleDocker-1/src/04/nginx/nginx.conf:/etc/nginx/nginx.conf -d ee49eece663b bash`

##### Проверить, что по localhost:80 доступна страничка написанного мини сервера

![pg1](img/38.png)<br/>

##### Дописать в *./nginx/nginx.conf* проксирование странички */status*, по которой надо отдавать статус сервера **nginx**

![pg1](img/39.png)<br/>

##### Перезапустить докер образ
##### Проверить, что теперь по *localhost:80/status* отдается страничка со статусом **nginx**

![pg1](img/40.png)<br/>

![pg1](img/41.png)<br/>

## Part 5. **Dockle**
##### Просканировать образ из предыдущего задания через `dockle [image_id|repository]`
`sudo dockle -ak NGINX_GPGKEY -ak NGINX_GPGKEY_PATH  ngnn:ng`

![pg1](img/39.png)<br/>

##### Исправить образ так, чтобы при проверке через **dockle** не было ошибок и предупреждений

![pg1](img/40.png)<br/>

## Part 6. Базовый **Docker Compose**

##### Написать файл *docker-compose.yml*, с помощью которого:
##### 1) Поднять докер контейнер из [Части 5](#part-5-инструмент-dockle) _(он должен работать в локальной сети, т.е. не нужно использовать инструкцию **EXPOSE** и мапить порты на локальную машину)_

![pg1](img/41.png)<br/>

##### 2) Поднять докер контейнер с **nginx**, который будет проксировать все запросы с 8080 порта на 81 порт первого контейнера
##### Замапить 8080 порт второго контейнера на 80 порт локальной машины

![pg1](img/42.png)<br/>

##### Остановить все запущенные контейнеры
##### Собрать и запустить проект с помощью команд `docker-compose build` и `docker-compose up`

![pg1](img/43.png)<br/>

![pg1](img/44.png)<br/>

##### Проверить, что в браузере по *localhost:80* отдается написанная вами страничка, как и ранее

![pg1](img/45.png)<br/>

![pg1](img/46.png)<br/>


